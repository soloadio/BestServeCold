version: "3.9"

services:
 frontend:
  build: ./frontend
  container_name: angular_frontend
  ports:
   - "4200:80"
  networks:
   - app_network
  depends_on:
   - backend

 backend:
  build: ./backend
  container_name: django_backend
  ports:
   - "8000:8000"
  environment:
   DJANGO_SECRET_KEY: ${DJANGO_SECRET_KEY}
   DJANGO_DEBUG: ${DJANGO_DEBUG}
   DJANGO_ALLOWED_HOSTS: ${DJANGO_ALLOWED_HOSTS}
   DATABASE_URL: ${DATABASE_URL}
  volumes:
   - ./backend:/app # Useful for dev to see live changes
  depends_on:
   - db
  networks:
   - app_network

 db:
  image: postgres:15
  container_name: postgres_db
  restart: always
  environment:
   POSTGRES_USER: ${POSTGRES_USER}
   POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
   POSTGRES_DB: ${POSTGRES_DB}
  volumes:
   - postgres_data:/var/lib/postgresql/data
  ports:
   - "5432:5432"
  networks:
   - app_network

networks:
 app_network:

volumes:
 postgres_data:
